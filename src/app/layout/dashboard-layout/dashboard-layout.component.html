<div class="min-vh-100 bg-light d-flex flex-column">

  <!-- Top Navigation -->
  <nav class="bg-white border-bottom sticky-top shadow-sm">
    <div class="container-fluid px-3">
      <div class="d-flex align-items-center justify-content-between" style="height:64px;">

        <!-- Left: Hamburger, Icon, Title -->
        <div class="d-flex align-items-center gap-3">
          <button class="btn btn-sm d-lg-none p-2" (click)="toggleMobileMenu()" aria-label="Toggle menu">
            <i [class]="'bi ' + (showMobileMenu ? 'bi-x-lg' : 'bi-list')"></i>
          </button>

          <div class="d-flex align-items-center justify-content-center rounded-2"
               [ngClass]="colorClass"
               style="width:40px;height:40px;">
            <i [class]="'bi ' + icon + ' text-white fs-5'"></i>
          </div>

          <div class="ms-2">
            <div class="h6 mb-0">{{ title }}</div>
            <div class="text-muted small d-flex align-items-center gap-1">
              <i class="bi bi-building-fill text-primary"></i>
              <span class="d-none d-sm-inline">{{ hotelName }}</span>
            </div>
          </div>
        </div>

        <!-- Right: Notifications & User -->
        <div class="d-flex align-items-center gap-2">

          <!-- Notifications button -->
          <div class="position-relative" (mouseleave)="showNotifications = false">
            <button class="btn p-2 rounded" (click)="toggleNotifications()" aria-label="Notifications">
              <i class="bi bi-bell fs-5 text-secondary"></i>
              <span *ngIf="unreadCount > 0"
                    class="position-absolute top-0 end-0 translate-middle p-1 bg-danger border border-white rounded-circle"
                    style="width:10px;height:10px;"></span>
            </button>

            <!-- Dropdown -->
            <div class="position-absolute end-0 mt-2 shadow rounded bg-white border"
                 *ngIf="showNotifications" style="width:320px; z-index:1200;">
              <div class="p-3 border-bottom">
                <strong>Notifications</strong>
              </div>

              <div class="max-vh-50 overflow-auto">
                <div *ngFor="let n of notifications" class="px-3 py-2 border-bottom"
                     [ngClass]="{'bg-light': n.unread}">
                  <div class="fw-semibold">{{ n.message }}</div>
                  <div class="text-muted small">{{ n.time }}</div>
                  <div class="mt-2">
                    <button class="btn btn-sm btn-link p-0" (click)="markRead(n.id)">Mark read</button>
                  </div>
                </div>
              </div>

              <div class="p-2 text-center border-top">
                <button class="btn btn-sm btn-link text-primary">View all notifications</button>
              </div>
            </div>
          </div>

          <!-- User menu -->
          <div class="position-relative" (mouseleave)="showUserMenu = false">
            <button class="btn d-flex align-items-center gap-2 p-2" (click)="toggleUserMenu()" aria-label="User menu">
              <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center text-white"
                   style="width:34px;height:34px;">
                <i class="bi bi-person"></i>
              </div>
              <div class="d-none d-sm-block text-start">
                <div class="fw-semibold small mb-0">{{ user?.name }}</div>
                <div class="text-muted small text-capitalize">{{ user?.role }}</div>
              </div>
            </button>

            <div class="position-absolute end-0 mt-2 shadow rounded bg-white border"
                 *ngIf="showUserMenu" style="width:200px; z-index:1200;">
              <div class="p-2">
                <button class="btn w-100 text-start mb-1" (click)="$event.preventDefault()">
                  <i class="bi bi-person me-2"></i> Profile
                </button>
                <button class="btn w-100 text-start text-danger" (click)="logout()">
                  <i class="bi bi-box-arrow-right me-2"></i> Sign Out
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </nav>

  <!-- Mobile Menu Overlay -->
  <div *ngIf="showMobileMenu" class="mobile-backdrop" (click)="showMobileMenu = false">
    <div class="mobile-drawer bg-white h-100 p-3" (click)="$event.stopPropagation()">
      <div class="mb-3">
        <div class="fw-semibold">{{ user?.name }}</div>
        <div class="text-muted text-capitalize small">{{ user?.role }}</div>
      </div>
      <button class="btn btn-outline-danger w-100" (click)="logout()">
        <i class="bi bi-box-arrow-right me-2"></i> Sign Out
      </button>
    </div>
  </div>

  <!-- Location bar -->
  <div *ngIf="locationInfo" class="bg-gradient-to-r p-2 border-bottom" >
    <div class="container-fluid d-flex justify-content-between align-items-center small text-secondary">
      <div class="d-flex align-items-center gap-2">
        <i class="bi bi-geo-alt-fill text-primary"></i>
        <span class="d-none d-sm-inline">Location:</span>
        <span>{{ locationInfo }}</span>
      </div>
      <div class="text-muted">{{ today }}</div>
    </div>
  </div>

  <!-- Main content -->
  <div class="container py-4">
  <router-outlet></router-outlet>
</div>

</div>
